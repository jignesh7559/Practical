@page
@model IndexModel
@{
    ViewData["Title"] = "Home page";
}
<html>
<head>
    <style>
        table, th, td {
            font-family: emoji;
            margin-left: auto;
            margin-right: auto;
            padding-left: 10px;
            border: 1px solid;
            padding-right: 10px;
        }

        .divCls {
            margin: auto;
            margin-top: 3%;
            width: 60%;
            border: 3px solid #73AD21;
            padding: 10px;
        }
    </style>
</head>
<body>

    <div class="text-center">
        <select id="StateDropDownId" style="width: 20%;height: 40px;">
            <option>Select Country</option>
            <option id="1">India</option>
            <option id="2">Indi</option>
            <option id="3">USA</option>
            <option id="4">CANADA</option>
        </select>
    </div>

    <div class="divCls" id="dynamicTable">
    </div>
</body>
</html>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js" type="text/javascript"></script>

<script>
    $(function () {
        $("#StateDropDownId").change(function () {


            var id = $("#StateDropDownId option:selected").attr("id");
            var value = $("#StateDropDownId").val();

            var locations = {
                'India': ['Delhi', 'Bangalore', 'Chennai', 'Trivandrum', 'ABC', 'tdt', 'fgf'],
                'Indi': ['Goa', 'XYZ'],
                'USA': ['New York', 'Seattle', 'San Diego', 'California', 'AAAAA', 'tt'],
                'CANADA': ['Montreal', 'Toronto', 'Vancouver', 'Ottawa', 'aasfd'],
            }

            var $locations = $('#location');
            var country = $(this).val(), lcns = locations[country] || [];            

            $("#dynamicTable").append("<table style='width:100%'>");
            $("#dynamicTable").append("<thead>");
            $("#dynamicTable").append("<tr>");
            $("#dynamicTable").append("</tr>");
            $("#dynamicTable").append("</thead>");

            $("#dynamicTable").append("<tbody>");
            $("#dynamicTable").append("<tr>");
            $("#dynamicTable").append("<td>" + value + "</td>");

            var GreateThanFifty = 0;
            var NameLessThanFifty = "";
            var NameGreateThanFifty = "";            
            var RenderedTd = 0;
            var LessThanFifty = 0;
            var RenderedTdGreateLength = 0;
            var LessThanFiftyRendredTd = 0;
            var Count = 0;
            var StaticLength = 15;
            
            var html = $.map(lcns, function (lcn) {

                Count += lcn.length;
                if (Count <= StaticLength) {
                    LessThanFifty = 1;
                    NameLessThanFifty += lcn + ",";
                }
                else {
                    LessThanFifty = 0;
                    if (RenderedTd == 0) {
                        GreateThanFifty = 1;
                    }
                }
                if (GreateThanFifty == 1) {
                    LessThanFifty = 0;
                    NameLessThanFifty = NameLessThanFifty.replace(/,\s*$/, "");
                    $("#dynamicTable").append("<td>" + NameLessThanFifty + "</td>");
                    RenderedTd = 1;
                    GreateThanFifty = 0;
                }

                if (Count > StaticLength) {

                    NameGreateThanFifty += lcn + ",";
                    if (NameGreateThanFifty.length < StaticLength) {
                        RenderedTdGreateLength = 0;
                    }
                    else {
                        if (RenderedTdGreateLength == 0) {
                            NameGreateThanFifty = NameGreateThanFifty.replace(/,\s*$/, "");
                            $("#dynamicTable").append("<td>" + NameGreateThanFifty + "</td>");
                            NameGreateThanFifty = "";
                            RenderedTdGreateLength = 1;
                        }
                    }
                }
            }).join('');

            if (LessThanFifty == 1) {
                NameLessThanFifty = NameLessThanFifty.replace(/,\s*$/, "");
                $("#dynamicTable").append("<td>" + NameLessThanFifty + "</td>");
                LessThanFiftyRendredTd = 1;
            }
            if (RenderedTdGreateLength == 0 && LessThanFiftyRendredTd != 1) {
                NameGreateThanFifty = NameGreateThanFifty.replace(/,\s*$/, "");
                $("#dynamicTable").append("<td>" + NameGreateThanFifty + "</td>");
            }
            $("#dynamicTable").append("</tr>");
            $("#dynamicTable").append("</tbody>");
            $("#dynamicTable").append("</table>");
            $locations.html(html)
        });
    });
</script>